
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>xelz's blog</title>
	<meta name="author" content="xelz">

	
	<meta name="description" content="Description 2D Life 470 points 1
2
3
4
http://110.10.212.135:24135
http://110.10.212.135:24136
http://110.10.212.147:24135
http://110.10.212.147: &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="xelz's blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <script src="/javascripts/jquery.min.js"></script>
    
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">xelz's blog</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://www.google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:xelz.info">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		
		<a class="github" href="https://github.com/xelzmm" title="GitHub">GitHub</a>
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="https://www.google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:xelz.info">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2017/02/20/codegate-2017-2d-life-writeup/">
		
			Codegate 2017 2D Life Writeup</a>
	</h2>
	<div class="entry-content">
		<h3>Description</h3>

<h4>2D Life</h4>

<p>470 points</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>http://110.10.212.135:24135
</span><span class='line'>http://110.10.212.135:24136
</span><span class='line'>http://110.10.212.147:24135
</span><span class='line'>http://110.10.212.147:24136</span></code></pre></td></tr></table></div></figure>


<p>I didn&rsquo;t have enough time to solve this challenge since I&rsquo;m busy at work. It&rsquo;s a pity that my team didn&rsquo;t, neither. But I have to say it&rsquo;s a very challenging one. Combination of crypto and SQL injection.</p>

<h3>First Sight</h3>

<p>It seemed to be a web challenge because the entrance was a website. So let&rsquo;s start with HTTP requests and responses. In the source code of the page, a path to secret login page was commented.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;navbar&quot;</span> <span class="na">class=</span><span class="s">&quot;navbar-collapse collapse&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;nav navbar-nav&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;/&quot;</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
</span><span class='line'>  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;?p=pic&quot;</span><span class="nt">&gt;</span>Pictures<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
</span><span class='line'>  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;?p=music&quot;</span><span class="nt">&gt;</span>Music<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
</span><span class='line'>  <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;?p=contact&quot;</span><span class="nt">&gt;</span>Contact<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
</span><span class='line'>  <span class="c">&lt;!--&lt;li&gt;&lt;a href=&quot;?p=secret_login&quot;&gt;Login&lt;/a&gt;&lt;li&gt;--&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>The login page set a cookie like this(using <a href="https://httpie.org/">httpie</a>)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>$ http http://110.10.212.135:24135/\?p\=secret_login
</span><span class='line'>HTTP/1.1 200 OK
</span><span class='line'>Connection: Keep-Alive
</span><span class='line'>Content-Encoding: gzip
</span><span class='line'>Content-Length: 579
</span><span class='line'>Content-Type: text/html; charset=UTF-8
</span><span class='line'>Date: Fri, 10 Feb 2017 05:57:50 GMT
</span><span class='line'>Keep-Alive: timeout=5, max=100
</span><span class='line'>Server: Apache/2.4.18 (Ubuntu)
</span><span class='line'>Set-Cookie: identify=t93ZpEcFoz4%3D%7C6uDGkD5VtEk0H9kAOzOrQECDzRdVuuDYn4h8ISoWSUuetH5Cb%2BBgSfxSd9WfX9RxHGC7cnAZdnmxqneZrLkQ%2Bw%3D%3D
</span><span class='line'>Vary: Accept-Encoding
</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s easy to say that the cookie is two parts of base64 encoded string concatenated by a <code>|</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>t93ZpEcFoz4=|6uDGkD5VtEk0H9kAOzOrQECDzRdVuuDYn4h8ISoWSUuetH5Cb+BgSfxSd9WfX9RxHGC7cnAZdnmxqneZrLkQ+w==
</span></code></pre></td></tr></table></div></figure>


<p>Different cookies was returned when repeating the same request. Modify the tail of the cookie will got a message <code>Error has occur from decrypt..</code>, but the head won&rsquo;t.</p>


		
		<a href="/blog/2017/02/20/codegate-2017-2d-life-writeup/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2017-02-20T20:00:00+00:00" pubdate data-updated="true">2017-02-20</time></div>
    

<div class="tags">

	<a class='category' href='/blog/categories/crypto/'>crypto</a>, <a class='category' href='/blog/categories/ctf/'>ctf</a>, <a class='category' href='/blog/categories/sqlinj/'>sqlinj</a>

</div>


    
        
            
    <div class="comments"><a href="/blog/2017/02/20/codegate-2017-2d-life-writeup/#disqus_thread">Comments</a></div>
            
        
    
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2017/02/18/lego-cube-solver/">
		
			我的玩具——乐高魔方机器人</a>
	</h2>
	<div class="entry-content">
		<iframe width="100%" height="450" src="https://www.youtube.com/embed/lXMsFn_69Dw" frameborder="0" allowfullscreen></iframe>


<p>没梯子请点<a href="http://player.youku.com/embed/XMjUyMDcxMDk1Mg==">优酷</a></p>

<h2>0x00 简要说明</h2>

<p><strong>硬件环境</strong>：Lego NXT 8547, iPhone 4S(需越狱)</p>

<p><strong>软件依赖</strong>：LeJOS, BTStack, OpenCV2</p>

<p><strong>还原效率</strong>：扫描10~15秒，计算&lt;1秒，还原~1分钟</p>


		
		<a href="/blog/2017/02/18/lego-cube-solver/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2017-02-18T20:00:00+00:00" pubdate data-updated="true">2017-02-18</time></div>
    

<div class="tags">

	<a class='category' href='/blog/categories/cube/'>cube</a>, <a class='category' href='/blog/categories/lego/'>lego</a>, <a class='category' href='/blog/categories/nxt/'>nxt</a>

</div>


    
        
            
    <div class="comments"><a href="/blog/2017/02/18/lego-cube-solver/#disqus_thread">Comments</a></div>
            
        
    
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2017/02/03/proxy-server-crawler/">
		
			Proxy Server Crawler</a>
	</h2>
	<div class="entry-content">
		<p>When we are doing security tests, we always change our IP address to bypass some security strategies. The easiest way to change IP is using a proxy.</p>

<p>Some websites can provide proxy IPs, but none of them can ensure the healthy of those proxy hosts. It&rsquo;s a horrible thing to check them one by one by hand when you wanna got one. So we can crawl these websites and test every proxy IP automatically.</p>

<p>The project is hosted at <a href="https://github.com/xelzmm/proxy_server_crawler">https://github.com/xelzmm/proxy_server_crawler</a>.</p>

<h2>Introduction</h2>

<p><strong>Proxy Server Crawler</strong> is a tool used to crawl public proxy servers from proxy websites. When crawled a proxy server(ip::port::type), it will test the functionality of the server automatically.</p>

<p>Currently supported websites:</p>

<ul>
<li><a href="http://www.66ip.cn">http://www.66ip.cn</a></li>
<li><a href="http://www.cz88.net">http://www.cz88.net</a></li>
<li><a href="http://www.cn-proxy.com">http://www.cn-proxy.com</a></li>
<li><a href="http://www.haodailiip.com">http://www.haodailiip.com</a></li>
<li><a href="http://www.kuaidaili.com">http://www.kuaidaili.com</a></li>
<li><a href="http://www.proxylists.net">http://www.proxylists.net</a></li>
<li><a href="http://www.qiaodm.net">http://www.qiaodm.net</a></li>
<li><a href="http://www.socks-proxy.net">http://www.socks-proxy.net</a></li>
<li><a href="http://www.xroxy.com">http://www.xroxy.com</a></li>
<li><a href="http://www.xicidaili.com">http://www.xicidaili.com</a></li>
</ul>


<p>Currently supported testing(for http proxy)</p>

<ul>
<li>ssl support</li>
<li>post support</li>
<li>speed (tested with 10 frequently used sites)</li>
<li>type(high/anonymous/transparent)</li>
</ul>



		
		<a href="/blog/2017/02/03/proxy-server-crawler/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2017-02-03T10:00:00+00:00" pubdate data-updated="true">2017-02-03</time></div>
    

<div class="tags">

	<a class='category' href='/blog/categories/security/'>security</a>

</div>


    
        
            
    <div class="comments"><a href="/blog/2017/02/03/proxy-server-crawler/#disqus_thread">Comments</a></div>
            
        
    
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/10/30/damned-rooms/">
		
			Damned Rooms</a>
	</h2>
	<div class="entry-content">
		<h2>游戏名称</h2>

<p><strong>密室惊魂Online</strong></p>

<h2>项目说明</h2>

<p>这个桌游是一个曾经开桌游店的同事送的，觉得这个游戏很有意思，但是一般需要5-8人，线下组局太难了。加入官方QQ群之后发现大家会在QQ群里通过建讨论组的方式来在线组局。此种方式需要一个MC主持游戏，每个人的选择和行动都是私聊给MC，MC通过PS软件绘制游戏地图，并通过各种图层来控制元素的堆放和移动，然后截图发在讨论组里。不禁感慨玩家的智慧是多么的强大。</p>

<p>后来我就在想，何不用程序来代替MC和PS呢？于是这个项目就诞生了。</p>

<p><strong>托管地址</strong>：<a href="https://github.com/xelzmm/danmned">https://github.com/xelzmm/danmned</a></p>

<p><strong>开发语言</strong>：nodejs</p>

<p><strong>相关技术</strong>：ejs, websocket, css3</p>

<p><strong>游戏截图</strong></p>

<p><img src="/assets/2015/damned.png" alt="教学界面" /></p>

<h2>游戏介绍</h2>

<p>密室惊魂是一款运用语言和推理逻辑，结合区域行动策略的版图桌面游戏。
游戏讲述一群中毒的受害者被奸徒困在一个完美密室里，大家需要在有限的时间内互相交流合作，寻找线索破解迷题，最终突破奸徒的阻挠找到出口逃生。该款游戏的特色是将玩家的语言交流和实际行动相结合，是一个考验玩家之间合作和显示玩家智慧的新型语言推理类桌面游戏。</p>

<p><strong>游戏人数</strong>： 5到9人，已支持3-4人的mini模式</p>

<p><strong>游戏时长</strong>： 约60至90分钟</p>

<p><strong>游戏类型</strong>： 语言推理类</p>


		
		<a href="/blog/2015/10/30/damned-rooms/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-10-30T10:00:00+00:00" pubdate data-updated="true">2015-10-30</time></div>
    

<div class="tags">

	<a class='category' href='/blog/categories/game/'>game</a>, <a class='category' href='/blog/categories/nodejs/'>nodejs</a>

</div>


    
        
            
    <div class="comments"><a href="/blog/2015/10/30/damned-rooms/#disqus_thread">Comments</a></div>
            
        
    
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/12/17/what-is-a-router/">
		
			什么是路由器(译)？</a>
	</h2>
	<div class="entry-content">
		<p>Origin：<a href="http://www.inetdaemon.com/tutorials/internet/ip/routing/define_router.shtml">http://www.inetdaemon.com/tutorials/internet/ip/routing/define_router.shtml</a></p>

<p>路由器(包括无线路由器)，是一种连接两个以上不同的网络、具备网络间数据包转发功能的专用网络设备。它基于IP协议，工作在网络层(OSI七层模型的第3层)。路由器的主要功能是将不同的网络连接起来，让它们相互间能够进行数据交换，并将局域网内不必要的广播流量精确地发送到目标主机。有很多制造路由器的厂商，简单列举一些：Cisco(思科)，Linksys，Juniper，Netgear(网件)，Nortel (北电)，Redback，Lucent(朗讯)，3Com，HP(惠普)，Dlink，Belkin(贝尔金)等。</p>

<p>有一些网络技能认证考试(如CCNA，CCNP，JNCIA，JNCIE)会考你区分网络设备的能力。这篇关于路由器的文章主要会解释如何辨别路由器，路由器有哪些功能(当然不包含某些厂商特有的技术)。</p>


		
		<a href="/blog/2014/12/17/what-is-a-router/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-12-17T03:36:53+00:00" pubdate data-updated="true">2014-12-17</time></div>
    

<div class="tags">

	<a class='category' href='/blog/categories/network/'>network</a>

</div>


    
        
            
    <div class="comments"><a href="/blog/2014/12/17/what-is-a-router/#disqus_thread">Comments</a></div>
            
        
    
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/07/28/resolve-google-ban-linode/">
		
			Solution for Google Banning Linodes</a>
	</h2>
	<div class="entry-content">
		<h3>Google banned Linodes</h3>

<p>I usually use linode to visit Google services via ssh tunnel. but recently I always got captchas even <code>Sorry...</code> page.</p>

<p>Finally I knows that google banned ipv6 traffics from linode which they treated as robots.</p>

<h3>Solution</h3>

<p>disable ipv6 of linode</p>

<h4>for Ubuntu</h4>

<p>append lines below to <code>/etc/sysctl.conf</code></p>

<ul>
<li><p>net.ipv6.conf.all.disable_ipv6=1</p></li>
<li><p>net.ipv6.conf.default.disable_ipv6=1</p></li>
<li><p>net.ipv6.conf.lo.disable_ipv6=1</p></li>
</ul>


<p>then restart network <code>/etc/init.d/networking restart</code> or <code>reboot</code></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-07-28T18:00:00+00:00" pubdate data-updated="true">2014-07-28</time></div>
    

<div class="tags">

	<a class='category' href='/blog/categories/tricks/'>tricks</a>

</div>


    
        
            
    <div class="comments"><a href="/blog/2014/07/28/resolve-google-ban-linode/#disqus_thread">Comments</a></div>
            
        
    
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/07/25/new-to-jekyll/">
		
			New to Jekyll!</a>
	</h2>
	<div class="entry-content">
		<p>Hello Jekyll.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-07-25T17:58:57+00:00" pubdate data-updated="true">2014-07-25</time></div>
    


    
        
            
        
    
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/06/09/write-up-of-a-very-interesting-wargame/">
		
			Write Up of a Very Interesting Wargame</a>
	</h2>
	<div class="entry-content">
		<p>Recently I&rsquo;m playing a wargame named [shhhh&hellip; edited].</p>

<p>I&rsquo;ve hidden the game name so that challengers could not find here by some searching work.</p>

<p>If you guys are about to cheat by this, get lost now.</p>

<p>You can find the game at [url]<code>c-a-n-y-o-u-h-a-c-k.i-t</code>(replace the dash with nothing)</p>

<p>Try to figure out by yourself, if you are really really really stucked, have a sight for some hints.</p>


		
		<a href="/blog/2014/06/09/write-up-of-a-very-interesting-wargame/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-06-09T18:00:00+00:00" pubdate data-updated="true">2014-06-09</time></div>
    

<div class="tags">

	<a class='category' href='/blog/categories/ctf/'>ctf</a>, <a class='category' href='/blog/categories/wargame/'>wargame</a>

</div>


    
        
            
    <div class="comments"><a href="/blog/2014/06/09/write-up-of-a-very-interesting-wargame/#disqus_thread">Comments</a></div>
            
        
    
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/04/20/for-our-one-year-anniversary/">
		
			For Our One Year Anniversary</a>
	</h2>
	<div class="entry-content">
		<p>I make this page to remember our love.</p>

<p>GitHub: <a href="https://github.com/xelzmm/Love">https://github.com/xelzmm/Love</a></p>

<p>View: <a href="http://iloveyamei.aliapp.com">http://iloveyamei.aliapp.com</a> | <a href="http://love.xelz.info">http://love.xelz.info</a></p>

<p><img src="/assets/2014/one-year.jpg" alt="" /></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-04-20T20:00:00+00:00" pubdate data-updated="true">2014-04-20</time></div>
    

<div class="tags">

	<a class='category' href='/blog/categories/live/'>live</a>

</div>


    
        
            
    <div class="comments"><a href="/blog/2014/04/20/for-our-one-year-anniversary/#disqus_thread">Comments</a></div>
            
        
    
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/06/28/defcon-ctf-qualifier-2013-3dub-3-write-up/">
		
			DefCon CTF Qualifier 2013 3dub 3 Write Up</a>
	</h2>
	<div class="entry-content">
		<p>mirror of <a href="http://www.blue-lotus.net/def-con-ctf-qualifier-2013-3dub-3-writeup/">http://www.blue-lotus.net/def-con-ctf-qualifier-2013-3dub-3-writeup/</a></p>

<p>First of all, we got a <code>secrets</code> link and <code>log in or create user</code> form. When we create and login, the website redirect us to the &lsquo;secrets&rsquo; page like this</p>

<blockquote><p>Secrets</p>

<p>name owner actions</p>

<p>key admin <a href="#">show</a></p>

<p>nothing asdf <a href="#">show</a></p>

<p><a href="#">new secret</a></p></blockquote>

<p>we&rsquo;ve got some links to see secrets owned by other users, include the <code>admin</code>, or easily add a new secret ourselves.</p>

<p>Having a try to open the admin&rsquo;s secret, we got a 500 Error Page with some error stack, which powered by the Ruby framework <code>Sinatra</code>.</p>

<p>From the very first sight of the page, it said <code>unauthorized</code> as the error message and a piece of source code was provided</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">redirect</span> <span class="s1">&#39;/secrets&#39;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">get</span> <span class="s1">&#39;/secrets/:id&#39;</span> <span class="k">do</span>
</span><span class='line'><span class="n">s</span> <span class="o">=</span> <span class="no">SECRETS</span><span class="o">[</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">].</span><span class="n">to_i</span><span class="o">]</span>
</span><span class='line'><span class="k">raise</span> <span class="s2">&quot;unauthorized&quot;</span> <span class="k">if</span> <span class="n">session</span><span class="o">[</span><span class="ss">:user_name</span><span class="o">]</span> <span class="o">!=</span> <span class="n">s</span><span class="o">.</span><span class="n">username</span>
</span><span class='line'>
</span><span class='line'><span class="n">haml</span> <span class="ss">:secret</span><span class="p">,</span> <span class="ss">locals</span><span class="p">:</span> <span class="p">{</span><span class="ss">secret</span><span class="p">:</span> <span class="n">s</span><span class="p">}</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">helpers</span> <span class="k">do</span>
</span><span class='line'><span class="k">def</span> <span class="nf">current_user</span>
</span><span class='line'>    <span class="k">return</span> <span class="kp">nil</span> <span class="k">unless</span> <span class="n">session</span><span class="o">[</span><span class="ss">:user_name</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>





		
		<a href="/blog/2013/06/28/defcon-ctf-qualifier-2013-3dub-3-write-up/" class="more-link">Read on &rarr;</a>
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-06-28T12:00:00+00:00" pubdate data-updated="true">2013-06-28</time></div>
    

<div class="tags">

	<a class='category' href='/blog/categories/ctf/'>ctf</a>, <a class='category' href='/blog/categories/web/'>web</a>

</div>


    
        
            
    <div class="comments"><a href="/blog/2013/06/28/defcon-ctf-qualifier-2013-3dub-3-write-up/#disqus_thread">Comments</a></div>
            
        
    
</div>
</article>

<nav id="pagenavi">
    
    
    <a href="/blog/page/2" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav>
</div>
	<footer id="footer" class="inner">Copyright &copy; 2017

    xelz

</footer>
	<script src="/javascripts/slash.js"></script>


<script type="text/javascript">
      var disqus_shortname = 'xelz';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//go.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-41665464-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>




</body>
</html>